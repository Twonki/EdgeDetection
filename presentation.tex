\documentclass[9pt,a4paper,titlepage,oneside,mathserif,serif]{beamer}
\usepackage[latin1]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
%%Required for Felix 4-Faced SubFigures
\usepackage{subcaption}
\usepackage{mwe}

\author{Leonhard Applis}
\title{Edge Detection}
\subtitle{}
\institute{TH Nürnberg} % (optional)
\date{05.11.2018}
\subject{AvBildMed}

\usetheme{PaloAlto}
\usecolortheme{beaver}
\AtBeginSection[]
{
\begin{frame}
	\frametitle{Table of Contents}
	\tableofcontents[currentsection,currentsubsection]
\end{frame}
}
%%------------------ for longer presentations required
\pgfmathsetmacro{\progress}{\insertframestartpage/\inserttotalframenumber}

\begin{document}
\frame{\titlepage}
\section{What makes an Edge?}
\begin{frame}
	\frametitle{What makes an edge?}
	\begin{columns}
		\begin{column}{0.5\textwidth}
			\begin{figure}
				\centering
				\includegraphics[width=0.8\linewidth]{images/Kadse}
				\caption[Felix]{Felix}
				\label{fig:kadse}
			\end{figure}
		\end{column}
		\begin{column}{0.5\textwidth} 
			\begin{center}
			\begin{figure}
				\centering
				\includegraphics[width=0.8\linewidth]{images/KadseCanny}
				\caption[Felix's Edges]{Felix's Edges}
				\label{fig:kadseCanny}
			\end{figure}
			\end{center}
		\end{column}
	\end{columns}
\end{frame}
\subsection{Problems}
\begin{frame}
	\frametitle{Problem I: Contrast}
	\begin{columns}
		\begin{column}{0.5\textwidth}
			\begin{figure}
				\centering
				\includegraphics[width=0.8\linewidth]{images/KadseHighContrast}
				\caption[High Contrast Felix]{High Contrast Felix}
				\label{fig:HighContrast}
			\end{figure}
		\end{column}
		\begin{column}{0.5\textwidth} 
			\begin{center}
				\begin{figure}
					\centering
					\includegraphics[width=0.8\linewidth]{images/KadseLowContrast}
					\caption[Low Contrast Felix]{Low Contrast Felix}
					\label{fig:LowContrast}
				\end{figure}
			\end{center}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}
	\frametitle{Problem II: Smoothness}
	\begin{center}
		\begin{figure}
			\centering
			\includegraphics[width=0.4\linewidth]{images/KadseSmooth}
			\caption[Smooth Felix]{Smooth Felix}
			\label{fig:Smooth}
		\end{figure}
	\end{center}
\end{frame}

\begin{frame}
	\frametitle{Problem III: Noise}
	\begin{center}
		\begin{figure}
			\centering
			\includegraphics[width=0.4\linewidth]{images/KadseSalty}
			\caption[Salted Felix]{Salted Felix}
			\label{fig:Salted}
		\end{figure}
	\end{center}
\end{frame}

\subsection{Definition}
\begin{frame}
	\frametitle{Definition}
	In Image Processing, an edge can be defined as a set of contiguous pixel positions where an abrupt change of intensity, gray- or color-values occur. Edges represent boundaries between objects and background. Sometimes, the edge-pixel-sequence may be broken due to insufficient intensity difference.(Malay K. Pakhira )
\end{frame}	

\section{Basics of gradient-based edgedetection}

\subsection{1D approach}
\begin{frame}
	\frametitle{One dimensional approach}
	\begin{center}
		\begin{figure}
			\centering
			\includegraphics[width=0.7\linewidth]{images/1DGradient}
			\caption[1D Gradient]{One dimensional image function and derivation}
			\label{fig:1dgradient}
		\end{figure}
		\b{Only applyable with known, steady functions}
	\end{center}
\end{frame}

\begin{frame}
	\frametitle{Approximating discrete derivation}
	Problem: the image function is discrete, therefore we need to approximate the derivation
	\begin{center}
		\begin{figure}
			\centering
			\includegraphics[width=0.7\linewidth]{images/1DGradientApproximation}
			\caption[1D Gradient Approximation]{Approximation of the derivation for discrete imagefunctions}
			\label{fig:1dgradientapprox}
		\end{figure}
		$\dfrac{df}{dx}(u) \approx \dfrac{f(u+1) - f(u-1)}{(u+1)-(u-1)} = \dfrac{f(u+1) - f(u-1)}{2}$
	\end{center}
\end{frame}

\subsection{2D Approach}
\begin{frame}
	\frametitle{Two dimensional approach}
	If working with full images,we got two dimensions and therefore two partial derivations:
	\begin{center}	
		$I_x = \dfrac{\partial I}{\partial x}(u,v) , I_y = \dfrac{\partial I}{\partial y}(u,v)$
	\end{center}
	the \textbf{gradient} at the point \textit{(u,v)} is \newline
	\begin{center}
		$\nabla I(u,v) =  \begin{pmatrix}I_x(u,v) \\ I_y(u,v)\end{pmatrix}$
	\end{center}	
	~\newline
	And the \textbf{magnitude} is \newline
	\begin{center}
		$|\nabla I|=\sqrt{I_x^2 + I_y^2}$
	\end{center}
\end{frame}

\begin{frame}
	\frametitle{Example}
	\begin{figure}
		\centering
		\includegraphics[width=0.5\linewidth]{images/2DEdgeGradient}
		\caption{Visualisation of simple gradient-based edgedetection}
		\label{fig:2dedgegradient}
	\end{figure}
\end{frame}
\subsection{Simple Example}
\begin{frame}
	\frametitle{Example with Felix}
	\begin{figure}
		\centering
		\begin{subfigure}[b]{0.175\textwidth}
			\centering
			\includegraphics[width=\textwidth]{images/Kadse}
			\caption[I]%
			{{\small I}}    
			\label{fig:RawFelix}
		\end{subfigure}
		\quad
		\begin{subfigure}[b]{0.175\textwidth}  
			\centering 
			\includegraphics[width=\textwidth]{images/KadseSimpleX}
			\caption[]%
			{{\small $I_x$}}    
			\label{fig:FelixX}
		\end{subfigure}
		\vskip\baselineskip
		\begin{subfigure}[b]{0.175\textwidth}   
			\centering 
			\includegraphics[width=\textwidth]{images/KadseSimpleY}
			\caption[]%
			{{\small $I_y$}}    
			\label{fig:FelixY}
		\end{subfigure}
		\quad
		\begin{subfigure}[b]{0.175\textwidth}   
			\centering 
			\includegraphics[width=\textwidth]{images/KadseSimple}
			\caption[]%
			{{\small $|\nabla I |$}}    
			\label{fig:FelixSimple}
		\end{subfigure}
		\caption[Simple Filters applied to Felix ]
		{\small Simple Filters applied to Felix\footnote{All images have a 50\% increased brightness}} 
		\label{fig:FullSimpleFelix}
	\end{figure}
	
	
\end{frame}
\subsection{Filters}
\begin{frame}
	\frametitle{Implementation with filters}
	\label{SimpleFilters}
	Expressing the gradient as a \textit{linear filter} is simple:
	\begin{columns}
		\begin{column}{0.5\textwidth}
			\begin{center}
				$I_x = \begin{bmatrix} -0.5 & 0 & 0.5\end{bmatrix}$
			\end{center}	
		\end{column}
		\begin{column}{0.5\textwidth} 
			\begin{center}
				$I_y = \begin{bmatrix} -0.5 \\ 0 \\ 0.5\end{bmatrix}$
			\end{center}
		\end{column}
	\end{columns}
\end{frame}

\section{Advanced gradient-based edgedetection}
\subsection{3x3 Filters}
\begin{frame}
	\frametitle{Prewitt Operator}
	\begin{center}
		Idea: Include neighboorhood
	\end{center}
	~\newline
	\begin{columns}
		\begin{column}{0.5\textwidth}
			\begin{center}
				$H^P_x = \begin{bmatrix}
				-1 & 0 & 1 \\ -1 & 0 & 1 \\ -1 & 0 & 1
				\end{bmatrix} $
			\end{center}	
		\end{column}
		\begin{column}{0.5\textwidth} 
			\begin{center}
				$H^P_y = \begin{bmatrix}
				-1 & -1 & -1 \\ 0 & 0 & 0 \\ 1 & 1 & 1
				\end{bmatrix} $
			\end{center}
		\end{column}
	\end{columns}
	~\newline
	\begin{center}
		$\nabla I^P(u,v)\approx \dfrac{1}{6} \cdot \begin{pmatrix}
		(I\ast H^P_x)(u,v) \\ (I\ast H^P_y)(u,v) 
		\end{pmatrix}$
	\end{center}
\end{frame}
\begin{frame}
	\frametitle{Sobel}
	\begin{center}
		Idea: Include neighboorhood but weight center more
	\end{center}
	~\newline	
	\begin{columns}
		\begin{column}{0.5\textwidth}
			\begin{center}
				$H^S_x = \begin{bmatrix}
				-1 & 0 & 1 \\ -2 & 0 & 2 \\ -1 & 0 & 1
				\end{bmatrix} $
			\end{center}	
		\end{column}
		\begin{column}{0.5\textwidth} 
			\begin{center}
				$H^S_y = \begin{bmatrix}
				-1 & -2 & -1 \\ 0 & 0 & 0 \\ 1 & 2 & 1
				\end{bmatrix} $
			\end{center}
		\end{column}
	\end{columns}
	~\newline
	\begin{center}
		$\nabla I^S(u,v)\approx \dfrac{1}{8} \cdot \begin{pmatrix}
		(I\ast H^S_x)(u,v) \\ (I\ast H^S_y)(u,v) 
		\end{pmatrix}$
	\end{center}
\end{frame}
\subsection{3x3 Examples}
\begin{frame}
	\frametitle{Comparison with Felix}
	\begin{columns}
		\begin{column}{0.33\textwidth}
			\begin{figure}
				\centering
				\includegraphics[width=0.8\linewidth]{images/KadseSimple}
				\caption[Simple edge filter]{Simple edge filter}
				\label{fig:Simple}
			\end{figure}
		\end{column}
		\begin{column}{0.33\textwidth}
				\begin{figure}
					\centering
					\includegraphics[width=0.8\linewidth]{images/KadsePrewitt}
					\caption[Prewitt Operator]{Prewitt Operator}
					\label{fig:KadsePrewitt}
				\end{figure}
		\end{column}
		\begin{column}{0.33\textwidth}
			\begin{figure}
				\centering
				\includegraphics[width=0.8\linewidth]{images/KadseSobel}
				\caption[Sobel Operator]{Sobel Operator}
				\label{fig:KadseSobel}
			\end{figure}
		\end{column}
	\end{columns}
\end{frame}
\subsection{Evaluations}
\begin{frame}
	\frametitle{Evaluations}
	\begin{center}
		\textbf{general magnitude}: $E(u,v) = \sqrt{I_x^2(u,v)+I_y^2(u,v)}$
		\newline holds for every Operator 
		~\newline
		\begin{figure}
			\centering
			\includegraphics[width=0.5\linewidth]{images/EdgeDirection}
			\caption[Visualisation of edge direction]{Visualisation of edge direction}
			\label{fig:edgedir}
		\end{figure}
		~\newline
		$\Phi(u,v)=\tan^{-1}\left(\dfrac{I_y(u,v)}{I_x(u,v)}\right)=\arctan(I_x(u,v),I_y(u,v))$
	\end{center}
	
\end{frame}

\section{Compass Operators}
\begin{frame}
	\frametitle{Compass Operators}
	\begin{columns}
		\begin{column}{0.69\textwidth}
			\textbf{Problem:} The stronger a filter responses to edge-like structures, the more sensitive it is to orientation \newline
			$\Uparrow Orientation \approx \Downarrow Edges$ $ \Uparrow Edges \approx \Downarrow Orientation $ \newline
			\textbf{Solution:} Apply 8 filters for each direction of the compass ~\newline \textbf{Produce two pictures:} One for the edge-strength taking the magnitude of the strongest activated filter, ~\newline one for the direction marking the strongest filter with colour 
		\end{column}
		\begin{column}{0.29\textwidth}
			\begin{figure}
				\centering
				\includegraphics[width=0.45\textwidth]{images/Kompass}
				\label{fig:Kompass}
			\end{figure}
		\end{column}	
	\end{columns}
\end{frame}

\begin{frame}
	\frametitle{Extended Sobel Operator}
	\begin{columns}
	\begin{column}{0.6\textwidth}
		\begin{figure}
			\centering
			\includegraphics[width=0.8\linewidth]{images/ExtendedSobel}
			\caption[Extended Sobel Operator]{Extended Sobel Operator}
			\label{fig:ESobel}
		\end{figure}
	\end{column}
	\begin{column}{0.4\textwidth}
		Note: Its only required to apply 4 filters, as they are symetric
	\end{column}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{Extended Sobel Example}
\begin{columns}
	\begin{column}{0.5\textwidth}
		\begin{figure}
			\centering
			\includegraphics[width=0.8\linewidth]{images/PhiFelix}
			\caption[$\Phi^{ES}(Felix)$]{$\Phi^{ES}(Felix)$}
			\label{fig:PhiFelix}
		\end{figure}
	\end{column}
	\begin{column}{0.5\textwidth}
		\begin{figure}
			\centering
			\includegraphics[width=0.8\linewidth]{images/PhiFelixColoured}
			\caption[Colour encoding]{Colour encoding}
			\label{fig:PhiFelixColour}
		\end{figure}
	\end{column}
\end{columns}
\end{frame}
\begin{frame}
\frametitle{Kirsch Operator}
\begin{columns}
	\begin{column}{0.6\textwidth}
		\begin{figure}
			\centering
			\includegraphics[width=0.8\linewidth]{images/KirschOperator}
			\caption[Kirsch Operator]{Kirsch Operator}
			\label{fig:Kirsch}
		\end{figure}
	\end{column}
	\begin{column}{0.4\textwidth}
		\begin{figure}
			\centering
			\includegraphics[width=0.8\linewidth]{images/KadseKirsch}
			\caption[Felix with Kirsch]{Felix with Kirsch}
			\label{fig:FelixKirsch}
		\end{figure}
	\end{column}
\end{columns}
\end{frame}

\begin{frame}
	\frametitle{Canny-Edge Operator}
	\begin{enumerate}
		\item Pre-Processing
		\item Edge Localization
		\item Edge Tracing and hysteresis threshholding
	\end{enumerate}
	For complex applications the Canny-Edge-Algorithm is done with more than 3x3 Filters
\end{frame}

\begin{frame}
	\frametitle{Canny-Edge}
	\framesubtitle{Pre-Processing}
	\begin{enumerate}
		\item Smooth Image with Gaussian-Filter
		\item Apply simple filters (See \ref{SimpleFilters})
		\item Calculate magnitude
	\end{enumerate}
	Also required: $\sigma$ as Gauss-Radious and $t_1,t_2$ for thresholding edges
\end{frame}

\begin{frame}
	\frametitle{Canny-Edge}
	\framesubtitle{Edge-Localization}
	\begin{figure}
		\centering
		\includegraphics[width=0.6\linewidth]{images/CannyEdgeLocalization}
		\caption[Edge-Localization]{Edge-Localization}
		\label{fig:cannyedgelocalization}
	\end{figure}
	Operate over the magnitude-image:\newline
	Null every value that is not a local-maximum in any direction 
\end{frame}

\begin{frame}
	\frametitle{Canny-Edge}
	\framesubtitle{Hysteresis Thresholding}
	\begin{columns}
		\begin{column}{0.6\textwidth}
			\begin{enumerate}
				\item Find points with $E \geq t_1$
				\item Add Every Neighboor with $E \geq t_2$
				\item Repeat $2$ until image is processed 
			\end{enumerate}
		\end{column}
		\begin{column}{0.4\textwidth}
			\begin{figure}
				\centering
				\includegraphics[width=0.9\textwidth]{images/KadseCanny}
				\caption[Canny-Edge Felix\footnote{Took ~30 seconds for Felix}]{Canny-Edge Felix}
				\label{fig:kadsecanny}
			\end{figure}	
		\end{column}
	\end{columns}
\end{frame}
\section{Edge Sharpening}
\begin{frame}
	\frametitle{Laplacian-Filter}
	\framesubtitle{Concept}
	\begin{columns}
		\begin{column}{0.5\textwidth}
			Idea: Alter \textit{steep} imagepoints \newline
			~\newline
			$\hat{f}(x)= f(x) + \omega \cdot f''(x)$ \newline
			~\newline
			Where $\omega$ is a weight for alternation, $f(x)$ is the image function
		\end{column}
		\begin{column}{0.5\textwidth}
			\begin{figure}
				\centering
				\includegraphics[width=0.8\linewidth]{images/Laplacian}
				\caption[Laplacian Plot]{Applying the Laplacian-Filter}
				\label{fig:laplacian}
			\end{figure}
		\end{column}
	\end{columns}
\end{frame}
\begin{frame}
	\frametitle{Laplacian-Filter}
	\framesubtitle{Implementation}

		Laplacian Operator: $(\nabla^2f)(x,y) = \dfrac{\partial^2f}{\partial^2x}(x,y) +\dfrac{\partial^2f}{\partial^2y}(x,y)$
		~\newline Expressed as filters: 
	\begin{center}
		~\newline ~\newline $\dfrac{\partial^2f}{\partial^2x}(x,y) \approx \begin{bmatrix} 1 & -2 & 1 \end{bmatrix}, \dfrac{\partial^2f}{\partial^2y}(x,y) \approx \begin{bmatrix} 1 \\ -2 \\ 1 \end{bmatrix}$ 
		~\newline
		$\Rightarrow H^L \approx \begin{bmatrix} 0 & 1 & 0 \\ 1 & -4 & 1 \\ 0 & 1 & 0 \end{bmatrix}$
	\end{center}
\end{frame}
\begin{frame}
	\frametitle{Laplacian-Filter}
	\framesubtitle{Variants and Example}
	\begin{columns}
		\begin{column}{0.5\textwidth}
			common variants: ~\newline ~\newline
			$H^L \approx \begin{bmatrix} 1 & 1 & 1\\ 1 & -8 & 1 \\ 1 & 1 & 1 \end{bmatrix}$
			
			~\newline ~\newline
			$H^L \approx \begin{bmatrix} 1 & 2 & 1\\2 & -12 & 2 \\ 1 & 2 & 1 \end{bmatrix}$
			
		\end{column}
		\begin{column}{0.5\textwidth}
			\begin{figure}
				\centering
				\includegraphics[width=0.7\linewidth]{images/KadseLaplace}
				\caption[FelixLaplace]{Laplacian Filter applied to Felix}
				\label{fig:kadselaplace}
			\end{figure}
			
		\end{column}
	\end{columns}
\end{frame}
\section{Summary}

\end{document}